<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Camera Nháº­n Diá»‡n Äá»“ Váº­t</title>

<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.10.0"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd"></script>

<style>
body {
    background: #111;
    color: #0f0;
    text-align: center;
    font-family: Arial;
}
video, canvas {
    border: 2px solid #0f0;
    margin-top: 10px;
}
#result {
    margin-top: 10px;
    font-size: 16px;
}
</style>
</head>

<body>
<h2>ğŸ“· AI Nháº­n Diá»‡n Äá»“ Váº­t & GiÃ¡ Trá»‹</h2>

<video id="video" width="320" height="240" autoplay></video>
<canvas id="canvas" width="320" height="240"></canvas>

<div id="result">Äang táº£i model...</div>

<script>
const video = document.getElementById("video");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const resultDiv = document.getElementById("result");

let model;

// ğŸ’° Báº£ng giÃ¡ giáº£ láº­p
const priceList = {
    "cell phone": "5.000.000Ä‘",
    "laptop": "15.000.000Ä‘",
    "bottle": "20.000Ä‘",
    "cup": "15.000Ä‘",
    "book": "50.000Ä‘",
    "person": "KhÃ´ng xÃ¡c Ä‘á»‹nh",
    "keyboard": "300.000Ä‘",
    "mouse": "150.000Ä‘"
};

// ğŸ¥ Má»Ÿ camera
navigator.mediaDevices.getUserMedia({ video: true })
.then(stream => {
    video.srcObject = stream;
})
.catch(err => {
    alert("KhÃ´ng má»Ÿ Ä‘Æ°á»£c camera!");
});

// ğŸ“¦ Load AI model
cocoSsd.load().then(m => {
    model = m;
    resultDiv.innerText = "âœ… AI sáºµn sÃ ng";
    detect();
});

// ğŸ” Nháº­n diá»‡n
async function detect() {
    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
    const predictions = await model.detect(canvas);

    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

    resultDiv.innerHTML = "";

    predictions.forEach(p => {
        const [x, y, w, h] = p.bbox;

        ctx.strokeStyle = "lime";
        ctx.lineWidth = 2;
        ctx.strokeRect(x, y, w, h);

        ctx.fillStyle = "lime";
        ctx.fillText(p.class, x, y - 5);

        let price = priceList[p.class] || "ChÆ°a cÃ³ giÃ¡";

        resultDiv.innerHTML += `
        ğŸ“¦ <b>${p.class}</b><br>
        ğŸ¯ Äá»™ chÃ­nh xÃ¡c: ${(p.score * 100).toFixed(1)}%<br>
        ğŸ’° GiÃ¡ trá»‹: ${price}<br><br>
        `;
    });

    requestAnimationFrame(detect);
}
</script>

</body>
</html>
